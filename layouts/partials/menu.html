<nav class="menu">
  <input id="menu-check" type="checkbox" hidden/>
  <label id="menu-label" for="menu-check" class="unselectable" hidden>
    <span class="icon close-icon">✕</span>
    <span class="icon open-icon">☰</span>
    <span class="text">Menu</span>
  </label>
  <ul>
  {{ $currentPage := . }}
  {{ $siteBase := $.Site.BaseURL }}
  {{ range (default .Site.Menus.main (index .Site.Menus ($.Scratch.Get "section"))) }}
  {{ $target := "" }}
  {{ with .Params.target }}{{ $target = . }}{{ end }}
  {{ if and (eq $target "") (or (hasPrefix .URL "http://") (hasPrefix .URL "https://")) }}
    {{ if not (hasPrefix .URL $siteBase) }}
      {{ $target = "_blank" }}
    {{ end }}
  {{ end }}
  <li{{ if eq .URL $currentPage.RelPermalink }} class="active"{{ end }}>
    <a href="{{ .URL }}"{{ if $target }} target="{{ $target }}" rel="noopener"{{ end }}>{{ .Name }}</a>
  </li>
  {{ end }}
  {{ partial "menu_extra.html" . }}
  </ul>
</nav>
